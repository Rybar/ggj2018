var Stats=function(){function t(t){return o.appendChild(t.dom),t}function e(t){for(var e=0;e<o.children.length;e++)o.children[e].style.display=e===t?"block":"none";n=t}var n=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(t){t.preventDefault(),e(++n%o.children.length)},!1);var r=(performance||Date).now(),i=r,a=0,s=t(new Stats.Panel("FPS","#0ff","#002")),l=t(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new Stats.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:o,addPanel:t,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(l.update(t-r,200),t>i+1e3&&(s.update(1e3*a/(t-i),100),i=t,a=0,u)){var e=performance.memory;u.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:o,setMode:e}};Stats.Panel=function(t,e,n){var o=1/0,r=0,i=Math.round,a=i(window.devicePixelRatio||1),s=80*a,l=48*a,u=3*a,f=2*a,d=3*a,c=15*a,p=74*a,h=30*a,v=document.createElement("canvas");v.width=s,v.height=l,v.style.cssText="width:80px;height:48px";var m=v.getContext("2d");return m.font="bold "+9*a+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=n,m.fillRect(0,0,s,l),m.fillStyle=e,m.fillText(t,u,f),m.fillRect(d,c,p,h),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(d,c,p,h),{dom:v,update:function(l,y){o=Math.min(o,l),r=Math.max(r,l),m.fillStyle=n,m.globalAlpha=1,m.fillRect(0,0,s,c),m.fillStyle=e,m.fillText(i(l)+" "+t+" ("+i(o)+"-"+i(r)+")",u,f),m.drawImage(v,d+a,c,p-a,h,d,c,p-a,h),m.fillRect(d+p-a,c,a,h),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(d+p-a,c,a,i((1-l/y)*h))}}},"object"==typeof module&&(module.exports=Stats),function(){function e(t=0){Y.fill(t,T,T+w)}function n(t=cursorX,e=cursorY,n=cursorColor,o=cursorColor2){cursorColor2=o,cursorColor=n;let r=(e|=0)%4*4+(t|=0)%4,i=pat&Math.pow(2,r);n|=0,pcolor=i?n:o,0!=pcolor&&(t<0|t>g-1||e<0|e>x-1||(Y[T+e*g+t]=i?n:o))}function o(t,e,o,r,i=cursorColor,a=cursorColor2){cursorColor2=a,cursorColor=i;var s,l,u=(r|=0)-(e|=0),f=(o|=0)-(t|=0);if(u<0?(u=-u,l=-1):l=1,f<0?(f=-f,s=-1):s=1,u<<=1,f<<=1,n(t,e,i),f>u)for(var d=u-(f>>1);t!=o;)d>=0&&(e+=l,d-=f),d+=u,n(t+=s,e,i);else for(d=f-(u>>1);e!=r;)d>=0&&(t+=s,d-=u),d+=f,n(t,e+=l,i)}function r(t,e,n=5,r=cursorColor,i=cursorColor2){if(cursorColor2=i,cursorColor=r,t|=0,e|=0,n|=0,r|=0,!(n<0)){t|=0,e|=0,r|=0;var a=-(n|=0),s=0,l=2-2*n;do{o(t-a,e-s,t+a,e-s,r),o(t-a,e+s,t+a,e+s,r),(n=l)<=s&&(l+=2*++s+1),(n>a||l>s)&&(l+=2*++a+1)}while(a<0)}}function i(t,e,n=16,r=16,i=cursorColor,a=cursorColor2){cursorColor2=a,cursorColor=i,x1=0|t,y1=0|e,n|=0,r|=0,i|=0;var s=Math.abs(r-y1);if(o(x1,y1,n,y1,i),s>0)for(;--s;)o(x1,y1+s,n,y1+s,i);o(x1,r,n,r,i)}function a(t=0,e=0,n=g,o=x,r=0,i=0,a=!1,s=!1,l=pal){t|=0,e|=0,n|=0,o|=0,r|=0,i|=0;for(var u=0;u<o;u++)for(var f=0;f<n;f++)i+u<x&&r+f<g&&i+u>-1&&r+f>-1&&(a&s?Y[L+((e+(o-u))*g+t+(n-f))]>=0&&(Y[T+((i+u)*g+r+f)]=l[Y[L+((e+(o-u-1))*g+t+(n-f-1))]]):s&&!a?Y[L+((e+(o-u))*g+t+f)]>=0&&(Y[T+((i+u)*g+r+f)]=l[Y[L+((e+(o-u-1))*g+t+f)]]):a&&!s?Y[L+((e+u)*g+t+(n-f-1))]>=0&&(Y[T+((i+u)*g+r+f)]=l[Y[L+((e+u)*g+t+(n-f-1))]]):a||s||Y[L+((e+u)*g+t+f)]>=0&&(Y[T+((i+u)*g+r+f)]=l[Y[L+((e+u)*g+t+f)]]))}function s(){for(var t=w;t--;)P[t]=G[pal[Y[t]]];E.data.set(K),A.putImageData(E,0,0)}function l(e){e[7]||(e[7]=1),e[8]||(e[8]=1);for(var o=e[0].length,r=0;r<o;r++){var a=[];a=f(e[0].charAt(r));for(var s=0;s<5;s++)for(var l=0;l<5;l++)if(1==a[5*s+l])if(1==e[4])n(e[1]+l*e[4]+(5*e[4]+e[3])*r,e[2]+(e[6]?Math.sin(1*(t+r*e[8])/e[7])*e[6]:0)+s*e[4]|0,e[5]);else{let n=e[1]+l*e[4]+(5*e[4]+e[3])*r,o=e[2]+(e[6]?Math.sin(1*(t+r*e[8])/e[7])*e[6]:0)+s*e[4]|0;i(n,o,n-1+e[4],o-1+e[4],e[5])}}}function u(t){var e=5*t[7],n=t[0].split("\n"),o=n.slice(0),r=n.length,i=o.sort(function(t,e){return e.length-t.length})[0],a=i.length*e+(i.length-1)*t[3],s=r*e+(r-1)*t[4];t[5]||(t[5]="left"),t[6]||(t[6]="bottom");var u=t[1],f=t[2],d=t[1]+a,c=t[2]+s;"center"==t[5]?(u=t[1]-a/2,d=t[1]+a/2):"right"==t[5]&&(u=t[1]-a,d=t[1]),"center"==t[6]?(f=t[2]-s/2,c=t[2]+s/2):"bottom"==t[6]&&(f=t[2]-s,c=t[2]);for(var p=u+a/2,h=f+s/2,v=0;v<r;v++){var m=n[v],y=m.length*e+(m.length-1)*t[3],g=t[1],x=t[2]+(e+t[4])*v;"center"==t[5]?g=t[1]-y/2:"right"==t[5]&&(g=t[1]-y),"center"==t[6]?x-=s/2:"bottom"==t[6]&&(x-=s),l([m,g,x,t[3]||0,t[7]||1,t[8],t[9],t[10],t[11]])}return{sx:u,sy:f,cx:p,cy:h,ex:d,ey:c,width:a,height:s}}function f(t){return index=fontString.indexOf(t),fontBitmap.substring(25*index,25*index+25).split("")}function d(t,e,n){this.context=t,this.urlList=e,this.onload=n,this.bufferList=new Array,this.loadCount=0}function c(t=Date.now(),e=1664525,n=1013904223,o=Math.pow(2,32)){this.seed=t,this.a=e,this.c=n,this.m=o}function p(e){var n=!1;return 0==Math.trunc(t)%Math.trunc(e.division)&&t>=e.next_div&&(e.next_div=Math.trunc(t)+Math.trunc(e.division),n=!0),n}function h(t){return Math.sin(6.283184*t)}function v(t){return.00390625*Math.pow(1.059463094,t-128)}function m(t,e){setTimeout(function(){var n=new Uint8Array(t*R*2),o=n.length-2,r=function(){for(var t=new Date,i=0;o>=0;)if(n[o]=0,n[o+1]=128,o-=2,(i+=1)%1e3==0&&new Date-t>B)return void setTimeout(r,0);setTimeout(function(){e(n)},0)};setTimeout(r,0)},0)}function y(t,e,n,o,r){var i=n.fx_delay_time*o>>1,a=n.fx_delay_amt/255,s=0,l=function(){for(var n=new Date,o=0;s<e-i;){var u=4*s,f=4*(s+i),d=t[f]+(t[f+1]<<8)+(t[u+2]+(t[u+3]<<8)-32768)*a;if(t[f]=255&d,t[f+1]=d>>8&255,d=t[f+2]+(t[f+3]<<8)+(t[u]+(t[u+1]<<8)-32768)*a,t[f+2]=255&d,t[f+3]=d>>8&255,++s,(o+=1)%1e3==0&&new Date-n>B)return void setTimeout(l,0)}setTimeout(r,0)};setTimeout(l,0)}const g=320,x=180,w=g*x,_=0,M=w,D=6*w;S=Math.sin,C=Math.cos,F=new AudioContext,audioMaster=F.createGain(),audioMaster.connect(F.destination),viewX=0,viewY=0,cursorX=0,cursorY=0,cursorColor=22,cursorColor2=0,fontString="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@#.'\"?/<()",fontBitmap="11111100011111110001100011111010001111101000111110111111000010000100000111111100100101000110001111101111110000111001000011111111111000011100100001000011111100001011110001111111000110001111111000110001111110010000100001001111111111000100001010010111101000110010111001001010001100001000010000100001111110001110111010110001100011000111001101011001110001011101000110001100010111011110100011001011100100000111010001100011001001111111101000111110100011000101111100000111000001111101111100100001000010000100100011000110001100010111010001100011000101010001001000110001101011010101110100010101000100010101000110001010100010000100001001111100010001000100011111001000110000100001000111001110100010001000100111111111000001001100000111110100101001011111000100001011111100001111000001111100111110000111101000101110111110000100010001000010001110100010111010001011100111010001011110000101110011101000110001100010111000000000000000000000111110010000100001000000000100111111000110111101011011101010111110101011111010100000000000000000000000100001100001000100000000000011011010011001000000000000111010001001100000000100000010001000100010001000000010001000100000100000100001000100001000010000010",dither=[65535,65527,65015,65013,62965,62901,58805,58789,42405,42401,42145,42144,41120,40992,32800,32768,0],pat=65535,palDefault=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63];var b=document.getElementById("canvas"),A=b.getContext("2d"),T=0,L=w,G=[4278715910,4279439380,4280620859,4281145203,4280950964,4280499935,4278872826,4280001529,4282504703,4282449151,4284805846,4282637212,4281712985,4281245716,4282284570,4282077732,4280295442,4284757012,4291058728,4292779812,4291286560,4292607142,4294967295,4290835454,4290303738,4288127221,4285754088,4288367292,4286593657,4283642688,4281606692,4279901218,4280822578,4282073457,4282873275,4284720347,4288467700,4293583066,4291934643,4289696651,4287460717,4284634186,4282464563,4281541698,4281872731,4283585166,4285167034,4288919017,4294960867,4294688697,4293172100,4290678104,4286938439,4283328291,4284777522,4287475549,4290436242,4293064653,4289385188,4287344839,4284647072,4283787129,4282666586,4281612610];pal=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],A.imageSmoothingEnabled=!1,b.width=g,b.height=x;var E=A.getImageData(0,0,g,x),k=new ArrayBuffer(E.data.length),K=new Uint8Array(k),P=new Uint32Array(k),Y=new Uint8Array(g*x*10);Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},Number.prototype.map=function(t,e,n,o){return(this-t)/(e-t)*(o-n)+n},Number.prototype.pad=function(t,e="0"){for(var n=String(this);n.length<(t||2);)n=e+n;return n},d.prototype.loadBuffer=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer";var o=this;n.onload=function(){o.context.decodeAudioData(n.response,function(n){n?(o.bufferList[e]=n,++o.loadCount==o.urlList.length&&o.onload(o.bufferList)):alert("error decoding file data: "+t)},function(t){console.error("decodeAudioData error",t)})},n.onerror=function(){alert("BufferLoader: XHR error")},n.send()},d.prototype.load=function(){for(var t=0;t<this.urlList.length;++t)this.loadBuffer(this.urlList[t],t)},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ONE:49,TWO:50,THREE:51,FOUR:52,a:65,c:67,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,i:73,j:74,k:75,l:76,isDown(t){return this._pressed[t]},justReleased(t){return this._released[t]},onKeydown(t){this._pressed[t.keyCode]=!0},onKeyup(t){this._released[t.keyCode]=!0,delete this._pressed[t.keyCode]},update(){this._released={}}},c.prototype.setSeed=function(t){this.seed=t},c.prototype.nextInt=function(){return this.seed=(this.seed*this.a+this.c)%this.m,this.seed},c.prototype.nextFloat=function(){return this.nextInt()/this.m},c.prototype.nextBool=function(t){return null==t&&(t=.5),this.nextFloat()<t},c.prototype.nextFloatRange=function(t,e){return t+this.nextFloat()*(e-t)},c.prototype.nextIntRange=function(t,e){return Math.floor(this.nextFloatRange(t,e))},c.prototype.nextColor=function(){for(var t=this.nextIntRange(0,Math.pow(2,24)).toString(16).toUpperCase();t.length<6;)t="0"+t;return"#"+t};var z={},R=2,B=33,F=null,I=[h,function(t){return h(t)<0?-1:1},function(t){return t%1-.5},function(t){var e=t%1*4;return e<2?e-1:3-e}];z.AudioGenerator=function(t){this.mixBuf=t,this.waveSize=t.length/R/2},z.AudioGenerator.prototype.getAudioBuffer=function(t){null===F&&(F=new AudioContext);var e=this.mixBuf,n=this.waveSize*R*2,o=F.createBuffer(R,this.waveSize,44100),r=o.getChannelData(0),i=o.getChannelData(1),a=0,s=function(){for(var l=new Date,u=0;a<n/2;){var f=4*(e[4*a]+(e[4*a+1]<<8)-32768);if(f=f<-32768?-32768:f>32767?32767:f,r[a]=f/32768,f=4*(e[4*a+2]+(e[4*a+3]<<8)-32768),f=f<-32768?-32768:f>32767?32767:f,i[a]=f/32768,a+=1,(u+=1)%1e3==0&&new Date-l>B)return void setTimeout(s,0)}setTimeout(function(){t(o)},0)};setTimeout(s,0)},z.SoundGenerator=function(t,e){this.instr=t,this.rowLen=e||5605,this.osc_lfo=I[t.lfo_waveform],this.osc1=I[t.osc1_waveform],this.osc2=I[t.osc2_waveform],this.attack=t.env_attack,this.sustain=t.env_sustain,this.release=t.env_release,this.panFreq=Math.pow(2,t.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,t.lfo_freq-8)/this.rowLen},z.SoundGenerator.prototype.genSound=function(t,e,n){new Date;for(var o=0,r=0,i=v(t+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),a=v(t+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),s=this.instr.fx_resonance/255,l=0,u=0,f=this.attack+this.sustain+this.release-1;f>=0;--f){var d=f+n,c=this.osc_lfo(d*this.lfoFreq)*this.instr.lfo_amt/512+.5,p=1;f<this.attack?p=f/this.attack:f>=this.attack+this.sustain&&(p-=(f-this.attack-this.sustain)/this.release);var m=i;this.instr.lfo_osc1_freq&&(m+=c),this.instr.osc1_xenv&&(m*=p*p),o+=m;var y=this.osc1(o)*this.instr.osc1_vol;m=a,this.instr.osc2_xenv&&(m*=p*p),r+=m,y+=this.osc2(r)*this.instr.osc2_vol,this.instr.noise_fader&&(y+=(2*Math.random()-1)*this.instr.noise_fader*p),y*=p/255;var g=this.instr.fx_freq;this.instr.lfo_fx_freq&&(g*=c);var x=s*(y-u)-(l+=(g=1.5*Math.sin(3.141592*g/44100))*u);switch(u+=g*x,this.instr.fx_filter){case 1:y=x;break;case 2:y=l;break;case 3:y=u;break;case 4:y=l+x}if(m=h(d*this.panFreq)*this.instr.fx_pan_amt/512+.5,y*=39*this.instr.env_master,(d*=4)+3<e.length){var w=e[d]+(e[d+1]<<8)+y*(1-m);e[d]=255&w,e[d+1]=w>>8&255,w=e[d+2]+(e[d+3]<<8)+y*m,e[d+2]=255&w,e[d+3]=w>>8&255}}},z.SoundGenerator.prototype.getAudioGenerator=function(t,e){var n=this.attack+this.sustain+this.release-1+32*this.rowLen,o=this;m(n,function(r){o.genSound(t,r,0),y(r,n,o.instr,o.rowLen,function(){e(new z.AudioGenerator(r))})})},z.SoundGenerator.prototype.createAudioBuffer=function(t,e){this.getAudioGenerator(t,function(t){t.getAudioBuffer(e)})},z.MusicGenerator=function(t){this.song=t,this.waveSize=44100*t.songLen},z.MusicGenerator.prototype.generateTrack=function(t,e,n){var o=this;m(this.waveSize,function(r){var i=o.waveSize,a=o.waveSize*R*2,s=o.song.rowLen,l=o.song.endPattern,u=new z.SoundGenerator(t,s),f=0,d=0,c=0,p=function(){for(var e=new Date;;)if(32!==c){if(d===l-1)return void setTimeout(h,0);var n=t.p[d];if(n){var o=t.c[n-1].n[c];o&&u.genSound(o,r,f)}if(f+=s,c+=1,new Date-e>B)return void setTimeout(p,0)}else c=0,d+=1},h=function(){y(r,i,t,s,m)},v=0,m=function(){for(var t=new Date,o=0;v<a;){var i=e[v]+(e[v+1]<<8)+r[v]+(r[v+1]<<8)-32768;if(e[v]=255&i,e[v+1]=i>>8&255,v+=2,(o+=1)%1e3==0&&new Date-t>B)return void setTimeout(m,0)}setTimeout(n,0)};setTimeout(p,0)})},z.MusicGenerator.prototype.getAudioGenerator=function(t){var e=this;m(this.waveSize,function(n){var o=0,r=function(){o<e.song.songData.length?(o+=1,e.generateTrack(e.song.songData[o-1],n,r)):t(new z.AudioGenerator(n))};r()})},z.MusicGenerator.prototype.createAudioBuffer=function(t){this.getAudioGenerator(function(e){e.getAudioBuffer(t)})},states={},init=(()=>{stats=new Stats,stats.showPanel(1),document.body.appendChild(stats.dom),lcg=new c(1019),sounds={},soundsLoaded=0,totalSounds=8,score=0,last=0,dt=0,now=0,t=0,bx=0,fill_y=x,filling=0,time_left=0,duration=180,fillColor=3,prevFillColor=5,five_div={division:5,next_div:0},thirty_div={division:30,next_div:0},next_duration=180,platformInterval=40,platformSpeed=.6,playerSpeed=2,gravity=8,drag=.8,jumpVelocity=4,state="proto",players=[{x:g/4,y:100,xvel:0,yvel:0,xSpeed:180,ySpeed:600,drag:.8,gravity:15,maxYvel:250,maxXvel:250,minYvel:-700,minXvel:-250,facingLeft:!1,jumping:!1,jumpCooldown:0},{x:g/4*3,y:100,xvel:0,yvel:0,xSpeed:80,ySpeed:80,drag:.8,gravity:8,maxYvel:150,maxXvel:-300,minYvel:-700,minXvel:-150,facingLeft:!1,jumping:!1,jumpCooldown:0}],difficulties=[{level:"low",platformMaxSize:g/2,platformMinSize:50},{level:"medium",platformMaxSize:g/4,platformMinSize:25},{level:"high",platformMaxSize:g/6,platformMinSize:20}],difficulty=difficulties[2],platforms=[],backgroundOrbs=[],platformColors=[3,19,35];for(let t=x;t>-300;t-=platformInterval){let n=Math.floor(Math.random()*Math.floor(3));var e=generatePlatform(t,difficulty,platformColors[n],0);platforms.push(e)}for(let t=-100;t<100;t++)backgroundOrbs.push({x:Math.random()*g/2,y:10*t,r:30*Math.random(),dither:6*Math.random()+7|0,color:29});paused=!1,F=new AudioContext,loop()}),window.addEventListener("keyup",function(t){Key.onKeyup(t)},!1),window.addEventListener("keydown",function(t){Key.onKeydown(t)},!1),window.addEventListener("blur",function(t){paused=!0},!1),window.addEventListener("focus",function(t){paused=!1},!1),window.addEventListener("gamepadconnected",function(t){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",t.gamepad.index,t.gamepad.id,t.gamepad.buttons.length,t.gamepad.axes.length)}),loop=(e=>{stats.begin(),gamepads=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],gp0=gamepads[0],gp1=gamepads[1],paused?u(["PAUSED",g/2,128,3,1,"center","top",4,21,0]):(pal=palDefault,t+=1,states[state].step(dt),states[state].render()),s(),stats.end(),requestAnimationFrame(loop)}),generatePlatform=((t,e,n,o)=>{var r=Math.floor(Math.random()*(e.platformMaxSize-e.platformMinSize))+e.platformMinSize,i=r/2,a=g/2-r/2,s=Math.floor(Math.random()*a-i)+i;return console.log("width:"+r),{x:s-r/2,y:t,x2:s+r/2,y2:t+5,color:n,color2:o}}),states.gameover={step:function(t){Key.isDown(Key.r)&&(state="menu")},render:function(t){T=0,e(0),cursorColor2=5,u(["GAME OVER",192,80,8,15,"center","top",4,27])}},states.menu={step:function(t){Key.isDown(Key.SPACE)&&(state="game")},render:function(t){u(["TITLE",g/2,50,14,20,"center","top",6,21])}},states.game={step(t){p(five_div)&&(time_left=duration,filling=1,prevFillColor=fillColor,6==++fillColor&&(fillColor=3)),1===filling?(fill_y=(duration-time_left)*x/duration,0>=--time_left&&(filling=0,fill_y=x)):duration!=next_duration&&(duration=next_duration),Key.isDown(Key.UP)&&(next_duration=next_duration<=232?next_duration+18:next_duration=250,console.log("duration changed to: "+next_duration)),Key.isDown(Key.DOWN)&&(next_duration=next_duration>=48?next_duration-18:next_duration=30,console.log("duration changed to: "+next_duration)),Key.isDown(Key.f)&&(state="gameover")},render(t){T=_,e(0),pat=dither[8],i(0,0,g,fill_y,fillColor,fillColor),1===filling&&i(0,fill_y+1,g,x,prevFillColor,prevFillColor)}},states.proto={step:function(t){platforms.forEach(function(t,e,n){if(pat=dither[0],t.y-viewY>x+20){n.splice(e,1);var o=generatePlatform(n[n.length-1].y-platformInterval,difficulty,19,0),r=generatePlatform(n[n.length-1].y-platformInterval,difficulty,3,0);n.push(o),n.push(r)}}),this.updatePlayer()},render:function(t){viewY=players[0].y-x/2,this.drawThings(0),this.drawPlayer(0),viewY=players[1].y-x/2,this.drawThings(1),this.drawPlayer(1)},drawThings:function(t){T=D,e(0),T=M,e(30),cursorColor2=0,backgroundOrbs.forEach(function(t){t.y-viewY<x+100&&t.y-viewY>-100&&(T=M,pat=dither[t.dither],r(t.x,t.y-viewY,t.r,t.color))}),platforms.forEach(function(t){t.y-viewY<x&&t.y-viewY>0&&(T=M,pat=dither[0],i(t.x,t.y-viewY,t.x2,t.y2-viewY,t.color,t.color-1),T=D,i(t.x,t.y-viewY,t.x2,t.y2-viewY,t.color))}),T=_;let n=0==t?0:g/2,o=0==t?g/2:g;pat=dither[0],i(n,x,o,x,30),a(0,0,g/2,x,0==t?0:g/2,0)},updatePlayer:function(){var t=players[0];players[1];t.oldX=t.x,t.oldY=t.y,t.xvel*=t.drag,t.yvel+=t.gravity,t.yvel=t.yvel.clamp(t.minYvel,t.maxYvel),t.xvel=t.xvel.clamp(t.minXvel,t.maxXvel);let e=1/60*t.xvel,n=1/60*t.yvel;t.x+=e,t.y+=n,t.yvel>0&&platforms.some(function(e){if(t.oldY+17<=e.y&&t.y+17>=e.y&&t.x+16>e.x&&t.x<e.x2)return t.yvel=0,t.y=e.y-17,t.jumping=!1,!0}),Key.isDown(Key.d)&&(t.facingLeft=!1,t.xvel=t.xSpeed,t.x>g/2-16&&(t.xvel=0)),Key.isDown(Key.a)&&(t.facingLeft=!0,t.xvel=-t.xSpeed,t.x<0&&(t.xvel=0)),t.x.clamp(t,0,g/2-16),(Key.isDown(Key.w)||Key.isDown(Key.SPACE))&&(t.jumping||(t.jumping=!0,t.yvel=-t.ySpeed)),gp0&&(Math.abs(gp0.axes[0])>.1&&(t.xvel+=gp0.axes[0]*t.maxXvel),gp0.buttons[11].pressed&&(t.jumping||(t.jumping=!0,t.yvel=-t.ySpeed)))},drawPlayer:function(t){let e=players[t];T=_,i(e.x,e.y-viewY,e.x+16,e.y+16-viewY,12,12)}},states.loading={init:function(t){},step:function(t){},render:function(n){T=_,e(0),u(["LOADING...",g/2,128+20*Math.sin(t),3,2,"center","top",3,9])}},window.onload=init()}();